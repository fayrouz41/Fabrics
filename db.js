const sqlite = require('sqlite3');
const db = new sqlite.Database('dbtables1.db');


const createSupplierTable = `CREATE TABLE IF NOT EXISTS SUPPLIER (
ID INTEGER PRIMARY KEY AUTOINCREMENT,
NAME TEXT NOT NULL,
EMAIL TEXT UNIQUE NOT NULL,
PASSWORD TEXT NOT NULL,
CONTACT_INFO TEXT NOT NULL
)`;

const createManufacturerTable = `CREATE TABLE IF NOT EXISTS MANUFACTURER (
ID INTEGER PRIMARY KEY AUTOINCREMENT,
NAME TEXT NOT NULL,
EMAIL TEXT UNIQUE NOT NULL,
PASSWORD TEXT NOT NULL,
CONTACT_INFO TEXT NOT NULL
)`;

const createStockTable = `CREATE TABLE IF NOT EXISTS STOCK (
ID INTEGER PRIMARY KEY AUTOINCREMENT,
NAME TEXT NOT NULL,
CATEGORY TEXT NOT NULL,
QUANTITY TEXT NOT NULL,  
DESCRIPTION TEXT,
PHOTOURL TEXT,
PRICE REAL NOT NULL,
SUPPLIER_ID INT NOT NULL,
FOREIGN KEY (SUPPLIER_ID) REFERENCES SUPPLIER(ID)
)`;

const createCartTable = `CREATE TABLE IF NOT EXISTS CART (
ID INTEGER PRIMARY KEY AUTOINCREMENT,
STOCK_ID INT NOT NULL,
MANUFACTURER_ID INT NOT NULL,
QUANTITY INT NOT NULL,
ORDER_DATE TEXT NOT NULL,
FOREIGN KEY (STOCK_ID) REFERENCES STOCK(ID),
FOREIGN KEY (MANUFACTURER_ID) REFERENCES MANUFACTURER(ID)
)`;

const createOrdersTable = `CREATE TABLE IF NOT EXISTS ORDERS (
ID INTEGER PRIMARY KEY AUTOINCREMENT,
USER_ID INT NOT NULL,
TOTAL_AMOUNT REAL NOT NULL,
ORDER_DATE TEXT NOT NULL,
FOREIGN KEY (USER_ID) REFERENCES SUPPLIER(ID) ON DELETE CASCADE
)`;

const createOrderItemsTable = `CREATE TABLE IF NOT EXISTS ORDER_ITEMS (
ID INTEGER PRIMARY KEY AUTOINCREMENT,
ORDER_ID INT NOT NULL,
STOCK_ID INT NOT NULL,
QUANTITY INT NOT NULL,
PRICE REAL NOT NULL,
FOREIGN KEY (ORDER_ID) REFERENCES ORDERS(ID) ON DELETE CASCADE,
FOREIGN KEY (STOCK_ID) REFERENCES STOCK(ID)
)`;


module.exports = { db, createSupplierTable, createManufacturerTable, createStockTable, createCartTable, createOrdersTable, createOrderItemsTable };